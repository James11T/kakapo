authenticate:
  post:
    operationId: authenticate-email-and-password
    summary: Authenticate with email and password
    description: Generate an access and refresh token pair from credentials, can return MFA challenges if needed.
    tags:
      - authentication
      - tokens
    requestBody:
      required: true
      content:
        application/json:
          schema:
            oneOf:
              - $ref: "../schemas/tokens.yaml#/components/credentials"
              - $ref: "../schemas/tokens.yaml#/components/credentialsWithMfa"
    responses:
      "200":
        description: Correct credentials.
        content:
          application/json:
            schema:
              $ref: "../schemas/tokens.yaml#/components/successfulAuthenticationResponseBody"
      "401":
        description: Indicates that either the credentials are incorrect or that MFA is required.
        content:
          application/json:
            schema:
              oneOf:
                - $ref: "../schemas/tokens.yaml#/components/mfaRequiredResponseBody"
                - $ref: "../schemas/tokens.yaml#/components/invalidCredentialsResponseBody"

refresh:
  post:
    operationId: refresh-access-token
    summary: Refresh an access token
    description: Generate a new access token from a given refresh token, may also create a new refresh token.
    tags:
      - authentication
      - tokens
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schemas/tokens.yaml#/components/refreshPayload"
    responses:
      "200":
        description: Successful refresh.
        content:
          application/json:
            schema:
              $ref: "../schemas/tokens.yaml#/components/successfulRefreshResponseBody"
      "401":
        description: Expired or invalid refresh token.
        content:
          application/json:
            schema:
              oneOf:
                - $ref: "../schemas/tokens.yaml#/components/invalidRefreshTokenResponseBody"
                - $ref: "../schemas/tokens.yaml#/components/expiredRefreshTokenResponseBody"
