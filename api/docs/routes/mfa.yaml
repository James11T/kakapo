mfa:
  get:
    operationId: get-mfa-status
    summary: Get MFA status
    description: Get the MFA status of the currently authenticated user.
    tags:
      - auth
      - mfa
    responses:
      "200":
        description: MFA status returned.
        content:
          application/json:
            schema:
              $ref: "../schemas/mfa.yaml#/components/mfaStatusResponseBody"

  post:
    operationId: add-mfa-source
    summary: Add MFA source
    description: Add a new authenticator app source.
    tags:
      - auth
      - mfa
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schemas/mfa.yaml#/components/addMfaSourceBody"
    responses:
      "200":
        description: MFA source added successfully.
        content:
          application/json:
            schema:
              $ref: "../schemas/mfa.yaml#/components/addMfaSourceResponseBody"
      "400":
        description: Bad parameters.
        content:
          application/json:
            schema:
              $ref: "../schemas/generic.yaml#/components/badParametersResponseBody"
              title: Invalid parameters

mfa-operations:
  patch:
    operationId: activate-mfa-source
    summary: Activate MFA source
    description: Activate an MFA source by providing a generated key.
    tags:
      - auth
      - mfa
    parameters:
      - $ref: "../schemas/mfa.yaml#/components/mfaIdPathProperty"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schemas/mfa.yaml#/components/mfaCodeBody"
    responses:
      "204":
        description: Successfully activated MFA source.
      "404":
        description: MFA source not found.
        content:
          application/json:
            schema:
              $ref: "../schemas/mfa.yaml#/components/mfaSourceNotFoundResponseBody"

  delete:
    operationId: remove-mfa-source
    summary: Remove MFA source
    description: Remove an active or inactive MFA source from the currently authenticated user.
    tags:
      - auth
      - mfa
    parameters:
      - $ref: "../schemas/mfa.yaml#/components/mfaIdPathProperty"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: "../schemas/mfa.yaml#/components/mfaCodeBody"
    responses:
      "204":
        description: Successfully removed MFA source.
      "404":
        description: MFA source not found.
        content:
          application/json:
            schema:
              $ref: "../schemas/mfa.yaml#/components/mfaSourceNotFoundResponseBody"
