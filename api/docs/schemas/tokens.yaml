components:
  credentials:
    title: Credentials
    type: object
    properties:
      email:
        $ref: "./generic.yaml#/components/email"
      password:
        $ref: "./generic.yaml#/components/password"

  credentialsWithMfa:
    title: Credentials with MFA
    allOf:
      - $ref: "#/components/credentials"
      - type: object
        properties:
          mfa:
            $ref: "./mfa.yaml#/components/mfaCode"

  refreshPayload:
    type: object
    properties:
      refreshToken:
        $ref: "./generic.yaml#/components/jwt"

  tokenPair:
    type: object
    properties:
      accessToken:
        $ref: "./generic.yaml#/components/jwt"
      refreshToken:
        $ref: "./generic.yaml#/components/jwt"
      validUntil:
        $ref: "./generic.yaml#/components/date"

  successfulAuthenticationResponseBody:
    title: Access granted
    $ref: "#/components/tokenPair"

  successfulRefreshResponseBody:
    title: Token refreshed
    $ref: "#/components/tokenPair"

  mfaRequiredResponseBody:
    type: object
    title: MFA required
    properties:
      error:
        type: string
        const: MFA_PENDING
      message:
        type: string
        const: An MFA pin is required
      source:
        $ref: "./mfa.yaml#/components/mfaType"

  invalidCredentialsResponseBody:
    type: object
    title: Invalid credentials
    properties:
      error:
        type: string
        const: INVALID_CREDENTIALS
      message:
        type: string
        const: The provided credentials are unknown or incorrect

  invalidRefreshTokenResponseBody:
    type: object
    title: Invalid refresh token
    properties:
      error:
        type: string
        const: INVALID_REFRESH_TOKEN
      message:
        type: string
        const: The provided token is malformed or invalid

  expiredRefreshTokenResponseBody:
    type: object
    title: Expired refresh token
    properties:
      error:
        type: string
        const: REFRESH_TOKEN_EXPIRED
      message:
        type: string
        const: The provided token is expired
