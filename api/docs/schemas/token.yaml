components:
  date:
    type: string
    example: 2012-04-23T18:25:43.511Z

  credentials:
    type: object
    properties:
      email:
        $ref: "./generic.yaml#/components/email"
      password:
        $ref: "./generic.yaml#/components/password"

  refreshPayload:
    type: object
    properties:
      accessToken:
        $ref: "./generic.yaml#/components/uuid"

  tokenPair:
    type: object
    properties:
      accessToken:
        $ref: "./generic.yaml#/components/uuid"
      refreshToken:
        $ref: "./generic.yaml#/components/uuid"
      validUntil:
        $ref: "#/components/date"

  successfulAuthenticationResponse:
    title: Correct Credentials
    $ref: "#/components/tokenPair"

  successfulRefreshResponse:
    title: Correct Credentials
    $ref: "#/components/tokenPair"

  mfaRequiredResponse:
    title: MFA Required
    type: object
    properties:
      error:
        type: string
        const: MFA_PENDING
      message:
        type: string
        const: An MFA pin is required
      source:
        type: string
        enum:
          - SMS
          - EMAIL
          - APP
        example: APP

  invalidCredentialsResponse:
    title: Invalid Credentials
    type: object
    properties:
      error:
        type: string
        const: INVALID_CREDENTIALS
      message:
        type: string
        const: The provided credentials are unknown or incorrect

  invalidRefreshTokenResponse:
    title: Invalid Refresh Token
    type: object
    properties:
      error:
        type: string
        const: INVALID_REFRESH_TOKEN
      message:
        type: string
        const: The provided token is malformed or invalid

  expiredRefreshTokenResponse:
    title: Expired Refresh Token
    type: object
    properties:
      error:
        type: string
        const: REFRESH_TOKEN_EXPIRED
      message:
        type: string
        const: The provided token is expired
